{"name": "test_Community_commentdetail", "status": "broken", "statusDetails": {"message": "TypeError: unhashable type: 'dict'", "trace": "self = <TestCase.Community.test_Community_commentdetail.TestCommunitycommentdetail object at 0x000001F9F66D8430>\n\n    def test_Community_commentdetail(self):\n        login()  # 调用登录接口通过token传出来\n        url = HTTP + \"/as_community/api/post/v1/add\"\n        headers = JSON\n    \n        # 拼装参数\n        paylo = {\n            \"title\": \"38万公里之外的亲密“牵手”\",\n            \"articleType\": 2,\n            \"content\": \"12月6日凌晨，嫦娥五号上升器成功与轨道器和返回器组合体交会对接，并将样品容器安全转移至返回器中。这是我国首次实现月球轨道交会对接，也是人类首次在月球轨道进行无人交会对接。按计划，嫦娥五号将于12月中下旬返回地球。[tag:00700.HK][tag:600519.SH]\",\n            \"images\": [{\n                \"name\": \"community/images/2020/12/04/16070706185435230.png\",\n                \"w\": 1000,\n                \"h\": 563,\n                \"url\": \"http://zhuorui-public.oss-cn-shenzhen.aliyuncs.com/community/images/2020/12/04/16070706185435230.png\"\n            }],\n            \"products\": [\n                {\n                    \"ts\": \"Hk\",\n                    \"code\": \"00700\",\n                    \"name\": \"腾讯控股\",\n                    \"type\": \"2\"\n                },\n                {\n                    \"ts\": \"SH\",\n                    \"code\": \"600519\",\n                    \"name\": \"贵州茅台\",\n                    \"type\": \"2\"\n                }\n            ]\n        }\n        # print(paylo)\n        sign1 = {\"sign\": get_sign(paylo)}  # 把参数签名后通过sign1传出来\n        payload1 = {}\n        payload1.update(paylo)\n        payload1.update(sign1)\n        headers = headers\n        # print(token)\n        # print(type(token))\n        token1 = yamltoken()\n        token = {\"token\": token1}\n        headers.update(token)  # 将token更新到headers\n        # print(headers)\n        payload = json.dumps(dict(payload1))\n        time.sleep(60.01)\n    \n        r = Requests(self.session).post(\n            url=url, headers=headers, data=payload, title=\"发帖\"\n        )\n        y = r.json()\n        postId = y.get(\"data\").get(\"postId\")\n        # print(postId)\n        body = {'postId': f\"{postId}\"}\n        body2 = {\n            \"content\": \" 弘扬中国航天精神，为强大祖国点赞[tag:600316.SH][tag:603698.SH]\",\n            \"products\": [\n                {\n                    \"ts\": \"SH\",\n                    \"code\": \"603698\",\n                    \"name\": \"航天工程\",\n                    \"type\": \"2\"\n                },\n                {\n                    \"ts\": \"SH\",\n                    \"code\": \"600316\",\n                    \"name\": \"洪都航空\",\n                    \"type\": \"2\"\n                }\n            ]\n        }\n        body1 = {}\n        body1.update(body)\n        body1.update(body2)\n        sign1 = {\"sign\": get_sign(body1)}  # 把参数签名后通过sign1传出来\n        body1.update(sign1)\n        body = json.dumps(dict(body1))\n        # print(body)\n        comment_url = HTTP + \"/as_community/api/comment/v1/add\"\n        # print(comment_url)\n        r = Requests(self.session).post(\n            url=comment_url, headers=headers, data=body, title=\"发表评论\"\n        )\n        j = r.json()\n        # print(j)\n        commentId = j.get(\"data\").get(\"commentId\")\n        body = {'commentId': f\"{commentId}\"}\n        body1 = {}\n        body1.update(body)\n        sign1 = {\"sign\": get_sign(body1)}\n        body1.update(sign1)\n        body = json.dumps(dict(body1))\n        commentdetail_url = HTTP + \"/as_community/api/comment/v1/detail\"\n        r = Requests(self.session).post(\n            url=commentdetail_url, headers=headers, data=body, title=\"查看评论详情\"\n        )\n        h = r.json()\n        # print(h)\n        # # 断言\n        assert r.status_code == 200\n        assert h.get(\"code\") == \"000000\"\n        assert h.get(\"msg\") == \"ok\"\n        if \"data\" in h:\n            if len(j.get(\"data\")) != 0:\n                assert \"postId\" in h.get(\"data\")\n                assert \"commentId\" in h.get(\"data\")\n                assert \"commentTime\" in h.get(\"data\")\n                q = OperationSql(\"192.168.1.237\", \"root\", \"123456\", \"user_account\")\n                userId = str(q.show_sql(\"select id from t_user_account where `zr_no`= '68904140';\"))\n                if \"fromUser\" in h.get(\"data\"):\n                    assert h.get(\"data\").get(\"fromUser\").get(\"userId\") == userId[3:-5:]\n                    assert h.get(\"data\").get(\"fromUser\").get(\"nickname\") == glo.nickname\n                    assert h.get(\"data\").get(\"fromUser\").get(\"headPhoto\") == glo.headPhoto\n                    assert h.get(\"data\").get(\"fromUser\").get(\"zrNo\") == glo.zrNo\n                assert h.get(\"data\").get(\"content\") == body2.get(\"content\")\n                assert \"products\" in h.get(\"data\")\n>               assert list(set(h.get(\"data\").get(\"products\")).difference(set(body2.get(\"products\")))) == []\nE               TypeError: unhashable type: 'dict'\n\ntest_Community_commentdetail.py:143: TypeError"}, "start": 1607335003742, "stop": 1607335063953, "uuid": "11efb290-fcdf-4d15-ada2-cf1ffbdde0cc", "historyId": "b308e4658b7c7c91af4fbd3d9fbaa14a", "testCaseId": "b6d8f4d8ed8565f58b683a8b60b0c615", "fullName": "TestCase.Community.test_Community_commentdetail.TestCommunitycommentdetail#test_Community_commentdetail", "labels": [{"name": "feature", "value": "社区-发表评论"}, {"name": "parentSuite", "value": "TestCase.Community"}, {"name": "suite", "value": "test_Community_commentdetail"}, {"name": "subSuite", "value": "TestCommunitycommentdetail"}, {"name": "host", "value": "DESKTOP-KBU1G8M"}, {"name": "thread", "value": "90356-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "TestCase.Community.test_Community_commentdetail"}]}